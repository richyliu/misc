<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="Chart.bundle.min.js"></script>


<!--<div id="container" style="min-width: 310px; height: 450px; margin: 0 auto"></div>-->

<div style="width: 800px; height: 400px">
    <canvas id="myChart"></canvas>
</div>


<script>
    /* global $ */
    

    
    $.get('data.txt', function(resp) {
        var data = resp.split('\n');
        var timestamp = eval(data[0]);
        var gyroX = [];
        var gyroY = [];
        var gyroZ = [];
        var acc = [];
        var genMov = [];
        
        for (var i = 1; i < data.length; i++) {
            var split = data[i].split(',');
            
            // ignore accelerometer data if all other data are 0
            if (data[i] === '-' || data[i].slice(-6) == ',0,0,0') {
                split = ['0', '0', '0', '0'];
                genMov.push(-1);
            } else {
                genMov.push(1);
            }
            
            acc.push(parseInt(split[0]));
            gyroX.push(parseInt(split[1]));
            gyroY.push(parseInt(split[2]));
            gyroZ.push(parseInt(split[3]));
        }
        
        // acc = [];
        gyroX = [];
        gyroY = [];
        gyroZ = [];
        genMov = [];
        
        
        
        Date.prototype.add = function(milliseconds) {
            return this.setMilliseconds(this.getMilliseconds() + milliseconds);
        };
        
        
        var startingDate = new Date(2000, 0, 1, 10, 45, 11);
        var dates = [];
        
        for (var i = 0; i < acc.length; i++) {
            dates.push(startingDate.add(200));
        }
        
        
        var ctx = document.getElementById("myChart");
        var scatterChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: dates,
                datasets: [{
                    label: 'acceleration',
                    data: acc
                }, {
                    label: 'gyro x',
                    data: gyroX
                }, {
                    label: 'gyro y',
                    data: gyroY
                }, {
                    label: 'gyro z',
                    data: gyroZ
                }, {
                    label: 'movement',
                    data: genMov
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'time',
                        time: {
                            unit: 'minute'
                        }
                    }]
                }
            }
        });
    });
</script>