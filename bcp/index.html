<!DOCTYPE html>
<html>

<head>
    <title>Browser Close Protector</title>
</head>

<body>
    <button type="button" onclick="window.disableAlert = true">Turn off</button>

    <script>
        window.disableAlert = false;
        
        
        window.setInterval(() => {
            let d = new Date();
            
            // if at 0 or 30 minutes of the hour
            if (d.getMinutes() % 30 === 0) {
                // if at botball then check location to make sure still at botball
                if (window.disableAlert) {
                    navigator.geolocation.getCurrentPosition(pos => {
                        // botball house (multiplied by 1000 to get 3 decimal precision)
                        window.disableAlert =
                            Math.round(pos.coords.latitude * 1000) == 37354 &&
                            Math.round(pos.coords.longitude * 1000) == -122075;
                    });
                // if not at botball start normal alert
                } else {
                    // continuously alert for 60 seconds
                    while (new Date() - d < 60 * 1000) {
                        alert((new Date() - d) / 1000);
                    }
                }
            }
        }, 1000 * 5); // wait 5 seconds between every check
    </script>
</body>

</html>