<!DOCTYPE html>
<html>

<head>
    <title>Browser Close Protector</title>
</head>

<body>
    <button type="button" onclick="checkDisableAlert()">Check if at Botball</button>

    <script>
        window.disableAlert = false;
        
        
        function checkDisableAlert() {
            navigator.geolocation.getCurrentPosition(pos => {
                // botball house (multiplied by 1000 to get 3 decimal precision)
                window.disableAlert =
                    Math.round(pos.coords.latitude * 1000) == 37354 &&
                    Math.round(pos.coords.longitude * 1000) == -122075;
            });
        }
        
        
        window.setInterval(() => {
            let d = new Date();
            
            if (d.getMinutes() % 15 === 0) {
                // if at botball then check location to make sure still at botball
                if (window.disableAlert) {
                    checkDisableAlert();
                } else {
                    let elapsedTime = (new Date() - d) * 1000;
                    let minutesMod30 = d.getMinutes() % 30;
                    // alert for 60 seconds every 30 minutes or 10 seconds every 15 minutes
                    while (elapsedTime < 60) {
                        elapsedTime = (new Date() - d) * 1000;
                        if ((minutesMod30 !== 0 && elapsedTime < 15) || minutesMod30 === 0) {
                            alert(elapsedTime);
                        }
                    }
                }
            }
        }, 1000 * 46); // wait 46 seconds between every check
    </script>
</body>

</html>